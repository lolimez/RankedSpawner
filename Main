package me.Jaliyiah.RankedSpawner;

import net.milkbowl.vault.economy.Economy;
import net.milkbowl.vault.economy.EconomyResponse;
import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.Material;
import org.bukkit.block.Block;
import org.bukkit.block.BlockState;
import org.bukkit.block.CreatureSpawner;
import org.bukkit.block.Sign;
import org.bukkit.command.Command;
import org.bukkit.command.CommandSender;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.entity.EntityType;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.block.Action;
import org.bukkit.event.block.BlockPlaceEvent;
import org.bukkit.event.player.PlayerInteractEvent;
import org.bukkit.event.player.PlayerJoinEvent;
import org.bukkit.inventory.ItemStack;
import org.bukkit.inventory.meta.ItemMeta;
import org.bukkit.plugin.RegisteredServiceProvider;
import org.bukkit.plugin.java.JavaPlugin;

import java.io.File;

public class Main extends JavaPlugin implements Listener {

    public static Economy economy = null;

    public static File folder;
    public static File file;
    public static FileConfiguration perms;

    @Override
    public void onEnable() {

        Bukkit.getPluginManager().registerEvents(this, this);

        folder = getDataFolder();

        file = new File(folder, "permissions.yml");

        perms = new YamlConfiguration();

        if (folder.exists() == false) {


            try {

                folder.mkdir();

            } catch (Exception e) {


            }

        }

        if (file.exists() == false) {

            try {

                file.createNewFile();

            } catch (Exception e) {


            }

        }

        try {

            perms.load(file);

        } catch (Exception e) {


        }

        if (!setupEconomy()) {

            getLogger().severe(String.format("[%s] - No Vault dependency was found, plugin disabled."));
            getServer().getPluginManager().disablePlugin(this);

            return;

        }

        Bukkit.getScheduler().scheduleSyncRepeatingTask(this, new Runnable() {

            @Override
            public void run() {

                perms = YamlConfiguration.loadConfiguration(file);

            }

        }, 100, 100);

    }

    @Override
    public void onDisable() {

        try {

            perms.save(file);

        } catch (Exception e) {



        }

    }

    public boolean setupEconomy() {

        if (getServer().getPluginManager().getPlugin("Vault") == null) {

            return false;

        }

        RegisteredServiceProvider<Economy> rsp = getServer().getServicesManager().getRegistration(Economy.class);

        if (rsp == null) {

            return false;

        }

        economy = rsp.getProvider();
        return rsp != null;

    }

    public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args) {

        Player p = (Player) sender;
        String uuid = p.getUniqueId().toString();

        perms = YamlConfiguration.loadConfiguration(file);

        try {

            perms.save(file);

        } catch (Exception exc) {



        }

        if (cmd.getName().equalsIgnoreCase("rankup")) {

            if (perms.getInt("Level." + uuid) == 1) {

                if (perms.getInt("Chicken." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 2" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 2);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Chicken Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 2) {

                if (perms.getInt("Pig." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 3" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 3);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Pig Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 3) {

                if (perms.getInt("Cow." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 4" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 4);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Cow Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 4) {

                if (perms.getInt("Spider." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 5" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 5);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Spider Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 5) {

                if (perms.getInt("Zombie." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 6" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 6);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Zombie Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 6) {

                if (perms.getInt("Skeleton." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 7" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 7);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Skeleton Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 7) {

                if (perms.getInt("Blaze." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 8" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 8);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Blaze Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 8) {

                if (perms.getInt("Creeper." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 9" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 9);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Creeper Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 9) {

                if (perms.getInt("Enderman." + uuid) == 1) {

                    Bukkit.broadcastMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + p.getName() + " has ranked up to " + ChatColor.UNDERLINE + "Level 10" + ChatColor.GRAY + "!");
                    perms.set("Level." + uuid, 10);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                    perms = YamlConfiguration.loadConfiguration(file);

                    try {

                        perms.save(file);

                    } catch (Exception exc) {



                    }

                } else {

                    p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to purchase a " + ChatColor.UNDERLINE + "Enderman Spawner" + ChatColor.GRAY + " before you can do this!");

                }

            } else if (perms.getInt("Level." + uuid) == 10) {

                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You are already the highest level!");

            }

        }

        return true;

    }

    @EventHandler
    public void onPlayerJoin(PlayerJoinEvent e) {

        Player p = e.getPlayer();

        String uuid = p.getUniqueId().toString();

        if (p.hasPlayedBefore()) {

            perms.set("PlayerInfo." + uuid, p.getName());

        } else {

            perms.set("Level." + uuid, 1);
            perms.set("Chicken." + uuid, 0);
            perms.set("Pig." + uuid, 0);
            perms.set("Cow." + uuid, 0);
            perms.set("Spider." + uuid, 0);
            perms.set("Zombie." + uuid, 0);
            perms.set("Skeleton." + uuid, 0);
            perms.set("Blaze." + uuid, 0);
            perms.set("Creeper." + uuid, 0);
            perms.set("Enderman." + uuid, 0);
            perms.set("IronGolem." + uuid, 0);

        }

    }

    @EventHandler
    public void onPlayerInteract(PlayerInteractEvent e) {

        Player p = e.getPlayer();
        String uuid = p.getUniqueId().toString();

        if (e.getAction() == Action.RIGHT_CLICK_BLOCK) {

            if (e.getClickedBlock().getType() == Material.SIGN_POST || e.getClickedBlock().getType() == Material.WALL_SIGN) {

                Sign sign = (Sign) e.getClickedBlock().getState();

                if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Chicken") && sign.getLine(2).equalsIgnoreCase("$5000") && sign.getLine(3).equalsIgnoreCase("1")) {

                    if (perms.getInt("Level." + uuid) >= 1) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 5000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Chicken Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Chicken Spawner" + ChatColor.GRAY + "!");

                                perms.set("Chicken." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Pig") && sign.getLine(2).equalsIgnoreCase("$15000") && sign.getLine(3).equalsIgnoreCase("2")) {

                    if (perms.getInt("Level." + uuid) == 2) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 15000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Pig Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Pig Spawner" + ChatColor.GRAY + "!");

                                perms.set("Pig." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 2" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Cow") && sign.getLine(2).equalsIgnoreCase("$25000") && sign.getLine(3).equalsIgnoreCase("3")) {

                    if (perms.getInt("Level." + uuid) >= 3) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 25000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Cow Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Cow Spawner" + ChatColor.GRAY + "!");

                                perms.set("Cow." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 3" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Spider") && sign.getLine(2).equalsIgnoreCase("$40000") && sign.getLine(3).equalsIgnoreCase("4")) {

                    if (perms.getInt("Level." + uuid) >= 4) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 40000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Spider Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Spider Spawner" + ChatColor.GRAY + "!");

                                perms.set("Spider." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 4" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Zombie") && sign.getLine(2).equalsIgnoreCase("$60000") && sign.getLine(3).equalsIgnoreCase("5")) {

                    if (perms.getInt("Level." + uuid) >= 5) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 60000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Zombie Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Zombie Spawner" + ChatColor.GRAY + "!");

                                perms.set("Zombie." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 5" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Skeleton") && sign.getLine(2).equalsIgnoreCase("$80000") && sign.getLine(3).equalsIgnoreCase("6")) {

                    if (perms.getInt("Level." + uuid) >= 6) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 80000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Skeleton Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Skeleton Spawner" + ChatColor.GRAY + "!");

                                perms.set("Skeleton." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 6" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Blaze") && sign.getLine(2).equalsIgnoreCase("$100000") && sign.getLine(3).equalsIgnoreCase("7")) {

                    if (perms.getInt("Level." + uuid) >= 7) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 100000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Blaze Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Blaze Spawner" + ChatColor.GRAY + "!");

                                perms.set("Blaze." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 7" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Creeper") && sign.getLine(2).equalsIgnoreCase("$200000") && sign.getLine(3).equalsIgnoreCase("8")) {

                    if (perms.getInt("Level." + uuid) >= 8) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 200000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Creeper Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased a " + ChatColor.UNDERLINE + "Creeper Spawner" + ChatColor.GRAY + "!");

                                perms.set("Creeper." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 8" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Enderman") && sign.getLine(2).equalsIgnoreCase("$500000") && sign.getLine(3).equalsIgnoreCase("9")) {

                    if (perms.getInt("Level." + uuid) >= 9) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 500000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "Enderman Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased an " + ChatColor.UNDERLINE + "Enderman Spawner" + ChatColor.GRAY + "!");

                                perms.set("Enderman." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 9" + ChatColor.GRAY + " to buy this spawner!");

                    }

                } else if (sign.getLine(0).equalsIgnoreCase("RankedSpawner") && sign.getLine(1).equalsIgnoreCase("Iron Golem") && sign.getLine(2).equalsIgnoreCase("$1000000") && sign.getLine(3).equalsIgnoreCase("10")) {

                    if (perms.getInt("Level." + uuid) >= 10) {

                        if (p.getInventory().firstEmpty() != -1) {

                            EconomyResponse er = economy.withdrawPlayer(p.getName(), 1000000);
                            if (er.transactionSuccess()) {

                                ItemStack spawner = new ItemStack(Material.MOB_SPAWNER);
                                ItemMeta spawnerMeta = spawner.getItemMeta();
                                spawnerMeta.setDisplayName(ChatColor.GOLD + "" + ChatColor.BOLD + "IronGolem Spawner");
                                spawner.setItemMeta(spawnerMeta);

                                p.getInventory().addItem(spawner);
                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You have purchased an " + ChatColor.UNDERLINE + "IronGolem Spawner" + ChatColor.GRAY + "!");

                                perms.set("IronGolem." + uuid, 1);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                perms = YamlConfiguration.loadConfiguration(file);

                                try {

                                    perms.save(file);

                                } catch (Exception exc) {



                                }

                                return;

                            } else {

                                p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You do not have the required funds to buy this!");

                            }

                        } else {

                            p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "Your inventory is full!");

                            return;

                        }

                    } else {

                        p.sendMessage(ChatColor.BLACK + "[" + ChatColor.DARK_PURPLE + "RankedSpawner" + ChatColor.BLACK + "] " + ChatColor.GRAY + "You need to be " + ChatColor.UNDERLINE + "Level 10" + ChatColor.GRAY + " to buy this spawner!");

                    }

                }

            } else if (e.getClickedBlock() == null) {

                return;

            }

        } else {

            return;

        }

    }

    @EventHandler
    public void onBlockPlace(BlockPlaceEvent e) {

        Player p = e.getPlayer();
        ItemStack item = p.getItemInHand();

        if (e.getBlock().getType() == Material.MOB_SPAWNER) {

            if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Chicken Spawner")) {

                setChicken(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Pig Spawner")) {

                setPig(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Cow Spawner")) {

                setCow(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Spider Spawner")) {

                setSpider(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Zombie Spawner")) {

                setZombie(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Skeleton Spawner")) {

                setSkeleton(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Blaze Spawner")) {

                setBlaze(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Creeper Spawner")) {

                setCreeper(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "Enderman Spawner")) {

                setEnderman(e.getBlockPlaced());

            } else if (item.getItemMeta().getDisplayName().equalsIgnoreCase(ChatColor.GOLD + "" + ChatColor.BOLD + "IronGolem Spawner")) {

                setIronGolem(e.getBlockPlaced());

            }

        } else {

            return;

        }

    }

    public void setChicken(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.CHICKEN);
                bs.update();

            }

        }, 1L);

    }

    public void setPig(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.PIG);
                bs.update();

            }

        }, 1L);

    }

    public void setCow(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.COW);
                bs.update();

            }

        }, 1L);

    }

    public void setSpider(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.SPIDER);
                bs.update();

            }

        }, 1L);

    }

    public void setZombie(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.ZOMBIE);
                bs.update();

            }

        }, 1L);

    }

    public void setSkeleton(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.SKELETON);
                bs.update();

            }

        }, 1L);

    }

    public void setBlaze(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.BLAZE);
                bs.update();

            }

        }, 1L);

    }

    public void setCreeper(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.CREEPER);
                bs.update();

            }

        }, 1L);

    }

    public void setEnderman(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.ENDERMAN);
                bs.update();

            }

        }, 1L);

    }

    public void setIronGolem(Block block) {

        Bukkit.getScheduler().scheduleSyncDelayedTask(this, new Runnable() {

            @Override
            public void run(){

                BlockState bs = block.getState();
                CreatureSpawner chickenSpawner = (CreatureSpawner) bs;
                chickenSpawner.setSpawnedType(EntityType.IRON_GOLEM);
                bs.update();

            }

        }, 1L);

    }

}
